
# Windows Impersonation


Windows uses a complex method of validating users, sometimes privs are not set up correct for user accounts and allow them to do things they
shouldnt be allowed to do.

``` powershell 
whoaim /priv
```

This will show the current users privs and the most commonly exploited are noted here: [Here](https://www.exploit-db.com/papers/4255)

## SeImpersonatePrivilege

If you have access to a meterpreter session and the SeImpersonatePrivilege is set to true, you can impersonate a user and move to a process that that user is running (like NT AUTHORITY\SYSTEM)

### Meterpreter commands

list_tokens - Self explanitory
impersonate_token - With the name of a user from above


Once impersonated, list out process and try to move to a process with migrate in meterpreter to move to that process
